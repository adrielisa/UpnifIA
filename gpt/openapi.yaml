openapi: 3.1.0
info:
  title: UpnifIA - API completa para Upnify CRM
  version: 1.0.1
  description: API REST para crear prospectos y consultar ventas desde GPT.
servers:
  - url: https://upnifia-production.up.railway.app
paths:
  /crear-prospecto-completo:
    post:
      summary: Crear prospecto en Upnify CRM
      operationId: crearProspecto
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nombre, apellidos, correo]
              properties:
                nombre:
                  type: string
                apellidos:
                  type: string
                correo:
                  type: string
                  format: email
                telefono2:
                  type: string
                movil:
                  type: string
                empresa:
                  type: string
                puesto:
                  type: string
                calle:
                  type: string
                ciudad:
                  type: string
                idEstado:
                  type: string
                codigoPostal:
                  type: string
                titulo:
                  type: string
                sexo:
                  type: string
                  enum: [H, M]
                url:
                  type: string
                colonia:
                  type: string
                idMunicipio:
                  type: string
                facebook:
                  type: string
                twitter:
                  type: string
                skype:
                  type: string
                linkedIn:
                  type: string
                googlePlus:
                  type: string
                etiquetas:
                  type: string
      responses:
        '200':
          description: Prospecto creado exitosamente
  /consultar-prospectos:
    get:
      summary: Consultar prospectos del día
      operationId: consultarProspectos
      responses:
        '200':
          description: Lista prospectos
  /consultar-ventas:
    get:
      summary: Consultar reportes de ventas con filtros flexibles
      operationId: consultarVentas
      parameters:
        - name: agrupacion
          in: query
          schema:
            type: integer
            enum: [1, 2, 3, 4, 5, 6, 17]
            default: 1
          description: |
            Tipo de agrupación:
            - 1: Por ejecutivo
            - 2: Por grupo  
            - 3: Por línea
            - 4: Por origen
            - 5: Por país
            - 6: Por región
            - 17: Por industria
        - name: periodicidad
          in: query
          schema:
            type: integer
            enum: [1, 2, 3, 4, 5, 6]
            default: 4
          description: |
            Periodicidad del reporte:
            - 1: Semestral
            - 2: Trimestral
            - 3: Bimestral
            - 4: Mensual
            - 5: Quincenal
            - 6: Semanal
        - name: anio
          in: query
          schema:
            type: integer
            minimum: 2009
            maximum: 2025
            default: 2025
          description: Año a consultar (2009-2025)
        - name: impuestos
          in: query
          schema:
            type: integer
            enum: [0, 1]
            default: 0
          description: |
            Incluir impuestos:
            - 0: Excluir impuestos
            - 1: Incluir impuestos
      responses:
        '200':
          description: Reporte de ventas con la agrupación y periodicidad solicitada
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  description: Registro de ventas con campos dinámicos según periodicidad
  /consultar-cobros-pendientes:
    get:
      summary: Consultar cobros pendientes con filtros
      operationId: consultarCobrosPendientes
      parameters:
        - name: agrupacion
          in: query
          schema:
            type: integer
            enum: [1, 2, 3, 4, 5, 6]
            default: 1
          description: |
            Tipo de agrupación:
            - 1: Por ejecutivo
            - 2: Por grupo  
            - 3: Por línea
            - 4: Por origen
            - 5: Por país
            - 6: Por región
        - name: periodicidad
          in: query
          schema:
            type: integer
            enum: [0, 1, 2, 3, 4, 5, 6]
            default: 4
          description: |
            Periodicidad del reporte:
            - 0: Anual
            - 1: Semestral
            - 2: Trimestral
            - 3: Bimestral
            - 4: Mensual
            - 5: Quincenal
            - 6: Semanal
      responses:
        '200':
          description: Reporte de cobros pendientes agrupado según filtros
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    indice:
                      type: integer
                    idPais:
                      type: string
                    idEstado:
                      type: string
                    estado:
                      type: string
                    moneda:
                      type: string
                    vencido:
                      type: number
                      description: Monto vencido
                    _P1:
                      type: number
                      description: Período 1
                    _PF:
                      type: number
                      description: Período final
                    _TOT:
                      type: number
                      description: Total
